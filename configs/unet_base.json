{
  "model": {
    "type": "UNet",
    "encoder": {
      "in_channels": 4,
      "out_channels": 64,
      "max_channels": 512,
      "norm_layer": "BatchNorm2d",
      "batchnorm_from": 0,
      "depth": 7
    },
    "decoder": {
      "depth": 7,
      "norm_layer": "BatchNorm2d",
      "attend_from": 3,
      "image_fusion": false
    }
  },
  "trainer": {
    "type": "SupervisedTrainer",
    "restore_scale": true
  },
  "optimizers": {
    "AdamW": {
      "encoder": {
        "lr": 1e-3,
        "weight_decay": 1e-4
      },
      "decoder": {
        "lr": 1e-3,
        "weight_decay": 1e-4
      }
    }
  },
  "metric_callbacks": [
    {
      "type": "MSECallback",
      "input_key": "outputs_255",
      "target_key": "targets_255",
      "metric_key": "MSE_255"
    },
    {
      "type": "PSNRCallback",
      "input_key": "outputs_255",
      "target_key": "targets_255",
      "metric_key": "PSNR_255",
      "max_pixel_value": 255
    },
    {
      "type": "FNMSECallback",
      "input_key": "outputs",
      "target_key": "targets_and_masks",
      "metric_key": "FN-MSE",
      "min_area": 100.0
    },
    {
      "type": "fMSECallback",
      "input_key": "outputs_255",
      "target_key": "targets_and_masks_255",
      "metric_key": "fMSE_255",
      "only_eval": true
    }
  ],
  "optimizers_callbacks": [
    {
      "metric_key": "FN-MSE",
      "optimizer_key": "AdamW"
    }
  ],
  "checkpoints_callbacks": [
    {
      "use": false,
      "loader_key": "valid",
      "metric_key": "FN-MSE",
      "minimize": true,
      "save_n_best": 1,
      "logdir": "somewhere"
    }
  ],
  "schedulers": {
    "AdamW": {
      "type": "MultiStepLR",
      "milestones": [160, 175],
      "gamma": 0.1,
      "mode": "epoch"
    }
  },
  "data": {
    "dataset_paths": {
      "HCOCO": "../data/HCOCO",
      "HAdobe5k": "../data/HAdobe5k",
      "HFlickr": "../data/HFlickr",
      "Hday2night": "../data/Hday2night"
    },
    "train": {
      "datasets": ["HCOCO", "HAdobe5k", "HFlickr", "Hday2night"],
      "augmentations": {
        "RandomResizedCrop": {
          "height": 256,
          "width": 256,
          "scale": [0.5, 1]
        },
        "HorizontalFlip": {}
      },
      "keep_without_mask": 0.05
    },
    "test": {
        "datasets": ["HCOCO", "HAdobe5k", "HFlickr", "Hday2night"],
        "augmentations": {
          "Resize": {
            "height": 256,
            "width": 256
          }
        }
    },
    "batch_size": 16,
    "num_workers": 12
  },
  "gpus": "",
  "num_epochs": 180,
  "project_name": "gml_harm_testing",
  "experiments_folder": "../diplom_exps"
}